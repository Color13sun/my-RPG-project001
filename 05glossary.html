<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <title>è¨­å®šè³‡æ–™é›†ãƒ»ã‚¨ãƒ³ãƒˆãƒªä¸€è¦§</title>
        <meta name="description" content="ã‚µã‚¤ãƒˆæ¦‚è¦èª¬æ˜">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- [if lt IE 9] -->
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
        <!-- [endif] -->
        <!-- Google font setup -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Hachi+Maru+Pop&display=swap" rel="stylesheet">
        <!-- Google font set -->
        <link rel="stylesheet" href="styles.css">
        <script src="data.js"></script>
    <style>
        /* styles.cssã®å†…å®¹ã¨ç«¶åˆã—ãªã„ã‚ˆã†ã€æ¤œç´¢ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ã“ã“ã§ä¸€æ™‚çš„ã«å®šç¾© */
        .controls {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            background-color: #ececec;
            display: flex;
            gap: 20px;
            align-items: center;
        }
        .controls input[type="text"], .controls select {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .controls label {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <header>
        ã€è‡ªä½œï¼²ï¼°ï¼§ï¼ˆã‚¿ã‚¤ãƒˆãƒ«æœªå®šï¼‰ã€‘ - è¨­å®šè³‡æ–™é›† ğŸ“–
    </header>

    <div class="container">
        <h1>ğŸ“š è¨­å®šè³‡æ–™ ã‚¨ãƒ³ãƒˆãƒªä¸€è¦§</h1>
        <a href="00index.html" class="back-link">ğŸ ï¸ ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>

        <div class="controls">
            <div>
                <label for="search-input">å˜èªæ¤œç´¢:</label>
                <input type="text" id="search-input" placeholder="åå‰ã€èª­ã¿ã‚’å…¥åŠ›" oninput="renderTable()">
            </div>
            
            <div>
                <label for="category-select">ã‚«ãƒ†ã‚´ãƒªãƒ¼:</label>
                <select id="category-select" onchange="renderTable()">
                    </select>
            </div>
        </div>

        <table id="entry-list-table">
            <thead>
                <tr>
                    <th>å˜èª</th>
                    <th>èª­ã¿</th>
                    <th>ã‚«ãƒ†ã‚´ãƒªãƒ¼</th>
                    <th>æ¦‚è¦</th>
                </tr>
            </thead>
            <tbody id="entry-tbody">
            </tbody>
        </table>
    </div>

    <footer>
        &copy; 2025 ã€Color-sunã€‘ã€€All Rights Reserved.
    </footer>

    <script>
        const tbody = document.getElementById('entry-tbody');
        const searchInput = document.getElementById('search-input');
        const categorySelect = document.getElementById('category-select');

        /**
         * 1. ã‚«ãƒ†ã‚´ãƒªãƒ¼é¸æŠè‚¢ã‚’ç”Ÿæˆã™ã‚‹
         */
        function setupCategorySelect() {
            // å…¨ã¦ã®ã‚«ãƒ†ã‚´ãƒªãƒ¼é…åˆ—ã‚’ãƒ•ãƒ©ãƒƒãƒˆåŒ–ã—ã€é‡è¤‡ã‚’å‰Šé™¤
            const allCategories = SETTING_DATA.flatMap(item => item.category);
            const categories = [...new Set(allCategories)].sort();

            categorySelect.innerHTML = '';

            // ã€Œå…¨ã¦è¡¨ç¤ºã€ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
            const allOption = document.createElement('option');
            allOption.value = 'all';
            allOption.textContent = 'å…¨ã¦è¡¨ç¤º';
            categorySelect.appendChild(allOption);

            // å„ã‚«ãƒ†ã‚´ãƒªãƒ¼ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
            categories.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                categorySelect.appendChild(option);
            });
        }


        /**
         * 2. ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€ä¸¦ã³æ›¿ãˆã€HTMLãƒ†ãƒ¼ãƒ–ãƒ«ã«åæ˜ ã•ã›ã‚‹
         */
        function renderTable() {
            const searchTerm = searchInput.value.toLowerCase().trim();
            const selectedCategory = categorySelect.value;

            // 1. ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
            let filteredData = SETTING_DATA.filter(item => {
                // A. ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿
                const matchesSearch = searchTerm === '' || 
                                      item.word.toLowerCase().includes(searchTerm) || 
                                      item.reading.toLowerCase().includes(searchTerm);
                
                // B. ã‚«ãƒ†ã‚´ãƒªãƒ¼ãƒ•ã‚£ãƒ«ã‚¿
                const matchesCategory = selectedCategory === 'all' || 
                                        item.category.includes(selectedCategory);

                // ä¸¡æ–¹ã®æ¡ä»¶ã‚’æº€ãŸã™ã‚‚ã®ã®ã¿æ®‹ã™
                return matchesSearch && matchesCategory;
            });

            // 2. äº”åéŸ³é †ã§ä¸¦ã³æ›¿ãˆã‚‹
            filteredData.sort((a, b) => a.reading.localeCompare(b.reading, 'ja'));

            // 3. ãƒ†ãƒ¼ãƒ–ãƒ«ã®æç”»
            tbody.innerHTML = '';

            if (filteredData.length === 0) {
                const emptyRow = tbody.insertRow();
                const cell = emptyRow.insertCell();
                cell.colSpan = 4;
                cell.style.textAlign = 'center';
                cell.textContent = 'è©²å½“ã™ã‚‹ã‚¨ãƒ³ãƒˆãƒªãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚';
                return;
            }

            filteredData.forEach(item => {
                const row = tbody.insertRow();
                const link = document.createElement('a');
                link.href = `detail.html?id=${item.id}`;
                link.textContent = item.word;
                
                row.insertCell().appendChild(link);
                row.insertCell().textContent = item.reading;
                row.insertCell().textContent = item.category.join(' / ');
                row.insertCell().textContent = item.meaning.join('');
            });
        }

        // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã®åˆæœŸå®Ÿè¡Œ
        setupCategorySelect(); // ã‚«ãƒ†ã‚´ãƒªãƒ¼é¸æŠè‚¢ã‚’æº–å‚™
        renderTable();         // æœ€åˆã®è¡¨ç¤ºã‚’å®Ÿè¡Œ
    </script>
</body>
</html>